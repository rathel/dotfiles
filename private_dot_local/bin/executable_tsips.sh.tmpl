#!/bin/bash

TSIPS="$(tailscale status | awk '{print $1}')"
HOSTIP="$(tailscale status | grep -i $(hostnamectl hostname) | awk '{print $1}')"
OFFLINE="$(tailscale status | grep -i offline | awk '{print $1}')"
#TERMINAL="kitty @ launch --type=tab"
TERMINAL="ghostty"
n=0

for i in $TSIPS; do
	case $i in
		$HOSTIP|$OFFLINE)	
			echo "Skipping Tailscale IP: $i."
			continue
			;;
		{{ .tailscale.ip.deck }})
			$TERMINAL -e ssh deck@"$i" >/dev/null 2>&1 &
			continue
			;;
		{{ .tailscale.ip.phone }})
			$TERMINAL -e ssh -p8022 u0_505@"$i" >/dev/null 2>&1 &
			continue
			;;
		{{ .tailscale.ip.pixelxl }})
			$TERMINAL -e ssh -p8022 u0_a213@"$i" >/dev/null 2>&1 &
			continue
			;;
		{{ .tailscale.ip.pixel6a }})
			$TERMINAL -e ssh -p8022 u0_a410@"$i" >/dev/null 2>&1 &
			continue
			;;
	esac

	notify-send "Connecting to" "$i"
	# ssh-copy-id rathel@$i
	# alacritty ssh rathel@$i &
	# kitty --detach kitten ssh rathel@$i &
	# wezterm ssh "$i" &
	sleep 0.5
	$TERMINAL -e ssh "$i" >/dev/null 2>&1 &
done

# vim: filetype=bash
